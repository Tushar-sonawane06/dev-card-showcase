<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Community Projects</title>

    <link rel="stylesheet" href="style.css" />
    <link rel="icon" type="image/png" href="Hall of Fame (1).png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="projects.css" />
  </head>

  <body>
    <div class="circle-container">
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
    </div>

    <!-- NAVBAR -->
    <nav class="navbar">
      <div class="logo">Dev Showcase</div>

      <div class="hamburger" id="hamburger">
        <span></span><span></span><span></span>
      </div>

      <ul class="nav-links" id="navLinks">
            <li><a href="index.html">Home</a></li>
            <li><a href="contribute.html">Contribute</a></li>
            <li><a href="https://github.com/Jayanta2004/dev-card-showcase" target="_blank">GitHub</a></li>
            <li><a href="projects.html">Projects</a></li>
            <li><a href="statistics.html">Statistics</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="faq.html">FAQ</a></li>
            <li><a href="guidelines.html">Guidelines</a></li>
            <li><a href="feedback.html">Feedback</a></li>
            <li><a href="bug-report.html">Bug Report</a></li>
            <li><a href="analytics.html">Analytics</a></li>
      </ul>

      <button id="themeToggle" class="theme-toggle">üåô</button>
    </nav>

    <!-- HEADER -->
    <header class="projects-header">
      <h1>Community Projects</h1>
      <p>
        A collection of small projects built by contributors. Learn, explore,
        and get inspired üå±
      </p>
    </header>

    <!-- VIEW TOGGLE -->
    <div
      style="
        display: flex;
        justify-content: flex-end;
        max-width: 1200px;
        margin: 0 auto 20px;
        padding: 0 20px;
      "
    >
      <button id="viewToggleBtn" class="view-toggle-btn" title="Toggle view">
        <i class="fas fa-th-large"></i>
      </button>
    </div>

    <!-- SEARCH AND FILTER -->
    <div class="search-filter-container">
      <input
        type="text"
        id="searchInput"
        placeholder="Search projects, tech, or contributor..."
      />
      <div class="filter-buttons">
        <button class="filter-btn active" data-tech="all">All</button>
        <button class="filter-btn" data-tech="html">HTML</button>
        <button class="filter-btn" data-tech="css">CSS</button>
        <button class="filter-btn" data-tech="javascript">JavaScript</button>
      </div>

      <select id="sortSelect" class="sort-select">
        <option value="az">A‚ÄìZ</option>
        <option value="za">Z‚ÄìA</option>
      </select>
    </div>

    <!-- PROJECTS GRID -->
    <section class="projects-container" id="projectsContainer">
      <!-- Projects will be loaded dynamically via JavaScript -->
      <div class="loading" style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--text-secondary);">
        <i class="fas fa-spinner fa-spin fa-2x"></i>
        <p style="margin-top: 10px;">Loading projects...</p>
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
      <p>¬© 2026 Community Hall of Fame</p>
      <p>Built with ‚ù§Ô∏è by the Open Source Community</p>
    </footer>

    <!-- Main JavaScript -->
    <script>
      // Global variables
      let projectsData = [];
      let projectCards = [];
      let activeFilter = "all";

      // Load projects from JSON
      async function loadProjects() {
        try {
          const response = await fetch('projects.json');
          if (!response.ok) throw new Error("Failed to load projects");
          projectsData = await response.json();
          renderProjects(projectsData);
          
          // If there is search/filter state, re-apply it?
          if (activeFilter !== 'all' || document.getElementById('searchInput').value) {
             runFilter(document.getElementById('searchInput').value.toLowerCase(), activeFilter);
          }
        } catch (error) {
          console.error("Error loading projects:", error);
          const container = document.getElementById("projectsContainer");
          if (container) {
             container.innerHTML = '<div class="loading">Error loading projects. Please refresh the page.</div>';
          }
        }
      }

      function renderProjects(projects) {
        const container = document.getElementById("projectsContainer");
        container.innerHTML = "";
        projectCards = [];

        // Note: runFilter logic expects 'noProjectsState' to exist in DOM.
        // It hides/shows it.
        // We will create it here so it's always available, but hidden by default except if projects is naturally empty on load.
        
        projects.forEach((project, index) => {
           const card = document.createElement("div");
           card.className = "project-card";
           card.style.setProperty("--project-index", index);
           
           if (project.links && project.links.live) {
             card.onclick = () => window.open(project.links.live, '_blank');
           }

           // Title
           const title = document.createElement("h2");
           title.textContent = project.title;
           card.appendChild(title);

           // Description
           const desc = document.createElement("p");
           desc.className = "project-desc";
           desc.textContent = project.description;
           card.appendChild(desc);

           // Tags
           const tagsContainer = document.createElement("div");
           tagsContainer.className = "project-tags";
           if (project.tags) {
             project.tags.forEach(tag => {
               const span = document.createElement("span");
               span.textContent = tag;
               tagsContainer.appendChild(span);
             });
           }
           card.appendChild(tagsContainer);

           // Links
           const linksContainer = document.createElement("div");
           linksContainer.className = "project-links";
           if (project.links) {
             if (project.links.github) {
               const gh = document.createElement("a");
               gh.href = project.links.github;
               gh.target = "_blank";
               gh.innerHTML = '<i class="fab fa-github"></i> GitHub';
               gh.onclick = (e) => e.stopPropagation();
               linksContainer.appendChild(gh);
             }
             if (project.links.live) {
               const live = document.createElement("a");
               live.href = project.links.live;
               live.target = "_blank";
               live.innerHTML = '<i class="fas fa-external-link-alt"></i> Live';
               live.onclick = (e) => e.stopPropagation();
               linksContainer.appendChild(live);
             }
           }
           card.appendChild(linksContainer);

           // Footer
           if (project.author) {
             const footer = document.createElement("div");
             footer.className = "project-footer";
             footer.innerHTML = `By <a href="${project.author.github}" target="_blank" onclick="event.stopPropagation()">${project.author.name}</a>`;
             card.appendChild(footer);
           }
           
           container.appendChild(card);
           projectCards.push(card);
        });

        // Append Empty State Element
        const emptyState = document.createElement("div");
        emptyState.id = "noProjectsState";
        emptyState.className = "empty-state";
        emptyState.innerHTML = '<i class="fas fa-search"></i><h3>No projects found</h3><p>Try adjusting your search or filters.</p>';
        container.appendChild(emptyState);
        
        // After rendering, update view mode if needed
        if (typeof isCompact !== 'undefined' && isCompact) {
             const projectsContainer = document.querySelector(".projects-container");
             if(projectsContainer) projectsContainer.classList.add("compact-view");
        }
      }

      // 1. Navbar Hamburger Menu Logic
      const hamburger = document.getElementById("hamburger");
      const navLinks = document.getElementById("navLinks");

      if (hamburger) {
        hamburger.addEventListener("click", () => {
          navLinks.classList.toggle("active");
        });
      }

      // 2. View Toggle (Grid vs List) Logic
      const viewToggleBtn = document.getElementById("viewToggleBtn");
      const projectsContainer = document.querySelector(".projects-container");
      let isCompact = false;

      if (viewToggleBtn) {
        viewToggleBtn.addEventListener("click", () => {
          isCompact = !isCompact;
          projectsContainer.classList.toggle("compact-view");
          viewToggleBtn.innerHTML = isCompact
            ? '<i class="fas fa-th-list"></i>'
            : '<i class="fas fa-th-large"></i>';
        });
      }

      // 3. Search, Filter, and Sort Logic
      const searchInput = document.getElementById("searchInput");
      const filterButtons = document.querySelectorAll(".filter-btn");
      const sortSelect = document.getElementById("sortSelect");

      // --- Search Event ---
      searchInput.addEventListener("input", () => {
        const query = searchInput.value.toLowerCase();
        runFilter(query, activeFilter);
      });

      // --- Filter Button Events ---
      filterButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          // Update UI: remove active class from all, add to clicked
          filterButtons.forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");

          // Update filter state and run logic
          activeFilter = btn.dataset.tech;
          runFilter(searchInput.value.toLowerCase(), activeFilter);
        });
      });

      // --- Sort Event ---
      sortSelect.addEventListener("change", () => {
        const visibleCards = projectCards.filter(
          (card) => card.style.display !== "none"
        );

        const sorted = visibleCards.sort((a, b) => {
          const nameA = a.querySelector("h2").innerText.toLowerCase();
          const nameB = b.querySelector("h2").innerText.toLowerCase();

          if (sortSelect.value === "az") {
            return nameA.localeCompare(nameB);
          } else {
            return nameB.localeCompare(nameA);
          }
        });

        // Re-inject cards into the DOM in the new sorted order
        const container = document.querySelector(".projects-container");
        sorted.forEach((card) => container.appendChild(card));
        
        // Ensure empty state remains at the bottom or handled?
        // Sorting reinjects CARDS. The empty state div (if it exists) might be pushed to top or bottom?
        // appendChild moves it to end.
        // If we only append cards, empty state (which is not in sorted) stays where it is?
        // Wait, container.appendChild(card) MOVES the card.
        // If empty state is in container, it will end up at the top if cards are moved after it?
        // No, if we append cards one by one, they go to the bottom.
        // So empty state will be at the top? That's bad.
        // We should append empty state again at the end.
        const emptyState = document.getElementById("noProjectsState");
        if(emptyState) container.appendChild(emptyState);
      });

      // --- Core Filtering Function ---
      function runFilter(query, tech) {
        let visibleCount = 0;
        projectCards.forEach((card) => {
          const title = card.querySelector("h2").innerText.toLowerCase();
          const tags = card.querySelector(".project-tags").innerText.toLowerCase();
          const author = card.querySelector(".project-footer").innerText.toLowerCase();

          // Check if it matches search text
          const matchesSearch = title.includes(query) ||
            tags.includes(query) ||
            author.includes(query);

          // Check if it matches selected technology
          const matchesTech = (tech === "all") || tags.includes(tech.toLowerCase());

          // Update visibility: matches both conditions?
          if (matchesSearch && matchesTech) {
            card.style.display = "";
            visibleCount++;
          } else {
            card.style.display = "none";
          }
        });

        // Show/Hide empty state
        const emptyState = document.getElementById("noProjectsState");
        if (emptyState) {
          if (visibleCount === 0) {
            emptyState.classList.add("visible");
          } else {
            emptyState.classList.remove("visible");
          }
        }
      }

      // Theme Toggle Script
      document.addEventListener("DOMContentLoaded", function () {
        const themeToggle = document.getElementById("themeToggle");
        const body = document.body;

        function setTheme(theme) {
          body.setAttribute("data-theme", theme);
          localStorage.setItem("theme", theme);
          themeToggle.textContent = theme === "dark" ? "üåô" : "‚òÄÔ∏è";
        }

        function toggleTheme() {
          const currentTheme = body.getAttribute("data-theme") || "dark";
          const newTheme = currentTheme === "dark" ? "light" : "dark";
          setTheme(newTheme);
        }

        const savedTheme = localStorage.getItem("theme") || "dark";
        setTheme(savedTheme);

        themeToggle.addEventListener("click", toggleTheme);

        // Load projects when page loads
        loadProjects();

        // Mouse trail animation
        const coords = { x: 0, y: 0 };
        const circles = document.querySelectorAll(".circle");

        circles.forEach(function (circle) {
          circle.x = 0;
          circle.y = 0;
        });

        window.addEventListener("mousemove", function (e) {
          coords.x = e.pageX;
          coords.y = e.pageY - window.scrollY;
        });

        function animateCircles() {
          let x = coords.x;
          let y = coords.y;
          circles.forEach(function (circle, index) {
            circle.style.left = `${x - 12}px`;
            circle.style.top = `${y - 12}px`;
            circle.style.transform = `scale(${(circles.length - index) / circles.length})`;
            const nextCircle = circles[index + 1] || circles[0];
            circle.x = x;
            circle.y = y;
            x += (nextCircle.x - x) * 0.3;
            y += (nextCircle.y - y) * 0.3;
          });

          requestAnimationFrame(animateCircles);
        }

        animateCircles();
      });
    </script>
  </body>
</html>